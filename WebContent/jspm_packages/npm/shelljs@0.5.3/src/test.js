/* */ 
var common = require('./common');
var fs = require('fs');
function _test(options, path) {
  if (!path)
    common.error('no path given');
  options = common.parseOptions(options, {
    'b': 'block',
    'c': 'character',
    'd': 'directory',
    'e': 'exists',
    'f': 'file',
    'L': 'link',
    'p': 'pipe',
    'S': 'socket'
  });
  var canInterpret = false;
  for (var key in options)
    if (options[key] === true) {
      canInterpret = true;
      break;
    }
  if (!canInterpret)
    common.error('could not interpret expression');
  if (options.link) {
    try {
      return fs.lstatSync(path).isSymbolicLink();
    } catch (e) {
      return false;
    }
  }
  if (!fs.existsSync(path))
    return false;
  if (options.exists)
    return true;
  var stats = fs.statSync(path);
  if (options.block)
    return stats.isBlockDevice();
  if (options.character)
    return stats.isCharacterDevice();
  if (options.directory)
    return stats.isDirectory();
  if (options.file)
    return stats.isFile();
  if (options.pipe)
    return stats.isFIFO();
  if (options.socket)
    return stats.isSocket();
}
module.exports = _test;
